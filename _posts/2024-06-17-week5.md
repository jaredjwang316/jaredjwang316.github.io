---
layout: post
title: Week 5 (6/17 - 6/21)
---

After realizing a mistake in my methodology, I reworked last week's task. Then, I moved on to converting all non-Maven projects in Defects4J into Maven projects. Many Defects4J projects are non-Maven, primarily using Ant and Gradle. Converting these projects to Maven will enable me to run PITest (PIT) for mutation testing.

Progress Update for this Week:

  - 6/17/2024
      - Completed last week's task, recording all the patches that did not apply and/or failed the test suite.  This task took several days to complete, especially since many patches required significant CPU time to process.  I sent my findings to Dr. Ghanbari, who plans to discuss them tomorrow during our weekly group meeting. 
  - 6/18/2024
      - In our meeting, Dr. Ghanbari pinpointed a minor flaw in my methodology. I checked out each buggy program once and applied all patches successively to the same instance.  This approach is incorrect since once a patch is applied, the program is no longer in its original state. Applying other patches to a modified program leads to erroneous results. Dr. Ghanbari recommended that I should checkout each bug for each patch individually and apply each patch to a fresh copy of the bug.
  - 6/19/2024
      - Following Dr. Ghanbari's advice, I rewrote the script as shown below:

                                            # Base directory containing the extracted dataset
                                            base_dir="/home/jwangj001/patches-dataset"  

                                            # Loop through each project directory
                                            for project_dir in "$base_dir"/*; do
                                              if [ -d "$project_dir" ]; then
                                                echo "Processing project directory: $project_dir"
                                                
                                                # Extract the project name and number from the directory name
                                                dir_name=$(basename "$project_dir")
                                                project_name=$(echo "$dir_name" | cut -d'-' -f1)
                                                project_number=$(echo "$dir_name" | cut -d'-' -f2)
                                                
                                                # Define the working directory for defects4j checkout
                                                work_dir="${project_dir}/${dir_name}"
                                                
                                                # Loop through each patch in the project directory
                                                for patch_file in "$project_dir"/*.patch; do
                                                  if [ -f "$patch_file" ]; then
                                                    echo "Applying patch: $patch_file"
                                                    
                                                    # Remove any existing work directory to ensure a fresh checkout
                                                    rm -rf "$work_dir"
                                                    
                                                    # Checkout the buggy program
                                                    defects4j checkout -p "$project_name" -v "${project_number}b" -w "$work_dir"
                                                    
                                                    # Change to the working directory
                                                    cd "$work_dir" || exit
                                                    
                                                    # Apply the patch
                                                    git apply --ignore-space-change --ignore-whitespace "$patch_file"
                                                    
                                                    # Run Defects4J test
                                                    defects4j test
                                                    
                                                    # Change back to the base directory
                                                    cd "$base_dir" || exit
                                                  fi
                                                done
                                              fi
                                            done
      - Running this script, I obtained significantly different findings.  
  - 6/20/2024
      - Completed last week's task and sent the new findings to Dr. Ghanbari, who approved them this time.
  - 6/21/2024
